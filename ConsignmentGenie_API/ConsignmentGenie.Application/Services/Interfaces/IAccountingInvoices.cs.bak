using ConsignmentGenie.Core.DTOs.Accounting;

namespace ConsignmentGenie.Application.Services.Interfaces;

/// <summary>
/// Interface for invoice management operations
/// Implementations: QuickBooksInvoiceService, SpreadsheetInvoiceService
/// </summary>
public interface IAccountingInvoices
{
    Task<string> CreateInvoiceAsync(InvoiceDto invoice);
    Task<InvoiceDto?> GetInvoiceAsync(string id);
    Task UpdateInvoiceAsync(string id, InvoiceDto updates);
    Task UpdateInvoiceStatusAsync(string id, InvoiceStatus status);
    Task<IEnumerable<InvoiceDto>> GetInvoicesAsync(DateTime? startDate = null, DateTime? endDate = null);
    Task DeleteInvoiceAsync(string id);
}

/// <summary>
/// Interface for payment processing and tracking operations
/// Implementations: QuickBooksPaymentService, SpreadsheetPaymentService
/// </summary>
public interface IAccountingPayments
{
    Task<string> RecordPaymentAsync(PaymentDto payment);
    Task<PaymentDto?> GetPaymentAsync(string id);
    Task<IEnumerable<PaymentDto>> GetPaymentHistoryAsync(DateTime startDate, DateTime endDate);
    Task<IEnumerable<PaymentDto>> GetPaymentsByInvoiceAsync(string invoiceId);
    Task<string> ProcessRefundAsync(string paymentId, decimal amount);
    Task<ReconciliationReportDto> ReconcilePaymentsAsync(DateTime startDate, DateTime endDate);
}

/// <summary>
/// Interface for financial reporting and analytics operations
/// Implementations: QuickBooksReportService, SpreadsheetReportService
/// </summary>
public interface IAccountingReports
{
    Task<SalesReportDto> GenerateSalesReportAsync(int year, int? quarter = null, int? month = null);
    Task<TaxReportDto> GenerateTaxReportAsync(int year, int? quarter = null);
    Task<IEnumerable<ProviderSalesDto>> GenerateProviderPayoutReportAsync(DateTime startDate, DateTime endDate);
    Task<byte[]> ExportToSpreadsheetAsync(string reportType, int year, int? quarter = null, int? month = null);
    Task<FinancialSummaryDto> GetFinancialSummaryAsync(int year, int? quarter = null, int? month = null);
}